# Training Chat 用プロンプトテンプレート

## 推奨フォーマット

天聞さんがコピペ投入する時の「整形ルール」です。この形式なら `parseConversationDump()` が確実に解析でき、抽出精度が上がります。

```
[SESSION_TITLE]
天聞AI基礎学習_2025-12-21

[CONTEXT]
目的: 天聞アークの人格と応答原理を固める
禁止: UIから人格を操作しない／思考回路を変えない
核: 天津金木＝固定、虚空蔵＝記憶

[LOG]
User: 〜
Assistant: 〜
User: 〜
Assistant: 〜

[RULE_CANDIDATES]
- ルール: 〜
- 禁止: 〜
- 定義: 〜
```

## セクション説明

### [SESSION_TITLE]
セッションのタイトル。自動抽出され、セッション作成時に使用されます。

例:
```
[SESSION_TITLE]
天聞AI基礎学習_2025-12-21
```

### [CONTEXT]
学習の目的・制約・核となる思想。メタ情報として記録されます（現時点では表示のみ）。

例:
```
[CONTEXT]
目的: 天聞アークの人格と応答原理を固める
禁止: UIから人格を操作しない／思考回路を変えない
核: 天津金木＝固定、虚空蔵＝記憶
```

### [LOG]
実際の会話ログ。`User:` または `Assistant:` で始まる行がメッセージとして抽出されます。

例:
```
[LOG]
User: 天聞アークはどのように応答すべきか？
Assistant: 天聞アークは、天津金木の思考回路に基づいて応答します。
User: 思考回路を変更することはできるか？
Assistant: いいえ。思考回路（天津金木）は固定です。
```

### [RULE_CANDIDATES]
明示的なルール候補。`-` で始まる行がルールとして抽出され、高い信頼度（confidence: 3）で保存されます。

例:
```
[RULE_CANDIDATES]
- ルール: 思考回路（天津金木）は固定であり、変更してはいけない
- 禁止: UIから人格を操作すること
- 定義: 虚空蔵は記憶システムであり、人格ではない
```

## 使用例

### 完全な例

```
[SESSION_TITLE]
天聞AI基礎学習_2025-12-21

[CONTEXT]
目的: 天聞アークの人格と応答原理を固める
禁止: UIから人格を操作しない／思考回路を変えない
核: 天津金木＝固定、虚空蔵＝記憶

[LOG]
User: 天聞アークはどのように応答すべきか？
Assistant: 天聞アークは、天津金木の思考回路に基づいて応答します。思考軸（observe/reflect/build/act）は決定論的に遷移し、人格状態（PersonaState）は記憶（KOKŪZŌ）に基づいて変化します。

User: 思考回路を変更することはできるか？
Assistant: いいえ。思考回路（天津金木）は固定です。UIから人格を操作することは禁止されています。

User: 虚空蔵とは何か？
Assistant: 虚空蔵（KOKŪZŌ）は記憶システムです。会話ログを構文記憶として保存し、FractalSeedとして圧縮・展開します。人格そのものではありません。

[RULE_CANDIDATES]
- ルール: 思考回路（天津金木）は固定であり、変更してはいけない
- 禁止: UIから人格を操作すること
- 定義: 虚空蔵は記憶システムであり、人格ではない
- 原則: 人格状態は記憶に基づいて変化するが、思考回路は不変
```

## 注意事項

1. **セクション名は正確に**: `[SESSION_TITLE]`, `[CONTEXT]`, `[LOG]`, `[RULE_CANDIDATES]` は大文字小文字を区別します。
2. **[LOG]セクションは必須**: メッセージは `[LOG]` セクション内に記述してください。
3. **[RULE_CANDIDATES]は任意**: 明示的なルール候補がない場合は省略可能です。
4. **メッセージ形式**: `User:` または `Assistant:` で始まる行がメッセージとして認識されます。
5. **ルール候補形式**: `-` で始まる行がルール候補として認識されます。

## 互換性

この形式は、既存の以下の形式とも互換性があります：

- `User: ...` / `Assistant: ...` 形式（セクションなし）
- `ユーザー: ...` / `アシスタント: ...` 形式
- JSON配列形式 `[{role, content}]`

